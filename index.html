<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Energy Consumption Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- React + ReactDOM CDN -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel (so JSX works in browser) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Recharts CDN -->
  <script src="https://unpkg.com/recharts/umd/Recharts.js"></script>

  <style>
    body {
      font-family: Arial;
      background: #eef2ff;
      margin: 0;
      padding: 20px;
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">

    const {
      BarChart, Bar, LineChart, Line, XAxis, YAxis,
      CartesianGrid, Tooltip, Legend, ResponsiveContainer,
      PieChart, Pie, Cell, Area, AreaChart
    } = Recharts;

    const EnergyDashboard = () => {
      const [selectedState, setSelectedState] = React.useState("Punjab");
      const [viewMode, setViewMode] = React.useState("overview");

      // Parse one-row CSV
      const rawData = React.useMemo(() => {
        const csvText = `,Punjab,Haryana,Rajasthan,Delhi,UP,Uttarakhand,HP,J&K,Chandigarh,Chhattisgarh,Gujarat,MP,Maharashtra,Goa,DNH,Andhra Pradesh,Telangana,Karnataka,Kerala,Tamil Nadu,Pondy,Bihar,Jharkhand,Odisha,West Bengal,Sikkim,Arunachal Pradesh,Assam,Manipur,Meghalaya,Mizoram,Nagaland,Tripura
02/01/2019 00:00:00,119.9,130.3,234.1,85.8,313.9,40.7,30,52.5,5,78.7,319.5,253,428.6,12.8,18.6,164.6,204.2,206.3,72.7,268.3,6.3,82.3,24.8,70.2,108.2,2,2.1,21.7,2.7,6.1,1.9,2.2,3.4`;

        const lines = csvText.trim().split("\n");
        const headers = lines[0].split(",").slice(1);
        const data = [];

        for (let i = 1; i < lines.length; i++) {
          const values = lines[i].split(",");
          const date = values[0];
          const row = { date };
          headers.forEach((h, idx) => {
            row[h] = parseFloat(values[idx + 1]) || 0;
          });
          data.push(row);
        }

        return { headers, data };
      }, []);

      // Stats
      const calculateStats = (state) => {
        const values = rawData.data.map((d) => d[state]);
        const sum = values.reduce((a, b) => a + b, 0);
        const avg = sum / values.length;
        const max = Math.max(...values);
        const min = Math.min(...values);

        return { avg, max, min, total: sum };
      };

      const currentStats = React.useMemo(
        () => calculateStats(selectedState),
        [selectedState]
      );

      return (
        <div>
          <h1 style={{ fontSize: "32px", fontWeight: "bold", color: "#1e1b4b" }}>
            ğŸ”Œ India Energy Dashboard
          </h1>

          <select
            value={selectedState}
            onChange={(e) => setSelectedState(e.target.value)}
            style={{ padding: "10px", marginTop: "20px", width: "300px" }}
          >
            {rawData.headers.map((state) => (
              <option key={state}>{state}</option>
            ))}
          </select>

          <h2 style={{ marginTop: "30px" }}>
            ğŸ“ˆ {selectedState} Consumption Trend
          </h2>

          <div style={{ width: "100%", height: 300 }}>
            <ResponsiveContainer>
              <AreaChart data={rawData.data}>
                <CartesianGrid strokeDasharray="3 3" />
                <XAxis dataKey="date" />
                <YAxis />
                <Tooltip />
                <Area
                  type="monotone"
                  dataKey={selectedState}
                  stroke="#8884d8"
                  fill="#c7d2fe"
                />
              </AreaChart>
            </ResponsiveContainer>
          </div>

          <h2 style={{ marginTop: "30px" }}>ğŸ† Stats for {selectedState}</h2>
          <ul>
            <li>Average: {currentStats.avg.toFixed(2)}</li>
            <li>Total: {currentStats.total.toFixed(2)}</li>
            <li>Max: {currentStats.max.toFixed(2)}</li>
            <li>Min: {currentStats.min.toFixed(2)}</li>
          </ul>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<EnergyDashboard />);
  </script>
</body>
</html>

